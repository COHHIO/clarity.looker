# hud <- hud_export$new("~/R/Contributor_Repos/COHHIO/COHHIOHMIS/Looker.ini")
# export_fields <- hud$sdk$describeFields(model = "cohhio_mig_connection_model", explore = "export")
# export_fields$name %>% stringr::str_extract("[a-z\\_]+(?<=\\.)") %>% unique %>% sort() %>% setNames(nm = .) %>% purrr::map(~{
#   stringr::str_subset(export_fields$name, paste0(.x, "\\."))
#  }) %>%
#   dput()
.export_fields <-
  list(
    csv_affiliation = c(
      "csv_affiliation.affiliation_id",
      "csv_affiliation.added_date",
      "csv_affiliation.date_deleted",
      "csv_affiliation.last_updated",
      "csv_affiliation.export_id",
      "csv_affiliation.id",
      "csv_affiliation.aff_res_proj_id",
      "csv_affiliation.ref_user"
    ),
    csv_assessment = c(
      "csv_assessment.assessment_date",
      "csv_assessment.assessment_id",
      "csv_assessment.assessment_level",
      "csv_assessment.assessment_location",
      "csv_assessment.assessment_type",
      "csv_assessment.added_date",
      "csv_assessment.date_deleted",
      "csv_assessment.last_updated",
      "csv_assessment.enrollment_id",
      "csv_assessment.export_id",
      "csv_assessment.ref_client",
      "csv_assessment.prioritization_status",
      "csv_assessment.ref_assessment",
      "csv_assessment.ref_user"
    ),
    csv_assessment_answers = c(
      "csv_assessment_answers.assessment_id",
      "csv_assessment_answers.assessment_answer",
      "csv_assessment_answers.assessment_question",
      "csv_assessment_answers.field_id"
    ),
    csv_assessment_questions = c(
      "csv_assessment_questions.assessment_id",
      "csv_assessment_questions.assessment_question_group",
      "csv_assessment_questions.assessment_question_id",
      "csv_assessment_questions.assessment_question_order",
      "csv_assessment_questions.added_date",
      "csv_assessment_questions.deleted",
      "csv_assessment_questions.last_updated",
      "csv_assessment_questions.enrollment_id",
      "csv_assessment_questions.export_id",
      "csv_assessment_questions.personal_id",
      "csv_assessment_questions.ref_user"
    ),
    csv_assessment_results = c(
      "csv_assessment_results.assessment_id",
      "csv_assessment_results.score",
      "csv_assessment_results.assessment_result_id",
      "csv_assessment_results.assessment_result_type",
      "csv_assessment_results.added_date",
      "csv_assessment_results.deleted",
      "csv_assessment_results.last_updated",
      "csv_assessment_results.enrollment_id",
      "csv_assessment_results.exportid",
      "csv_assessment_results.ref_client",
      "csv_assessment_results.ref_user"
    ),
    csv_client = c(
      "csv_client.birth_date",
      "csv_client.dob_quality",
      "csv_client.added_date",
      "csv_client.date_deleted",
      "csv_client.last_updated",
      "csv_client.export_id",
      "csv_client.first_name",
      "csv_client.last_name",
      "csv_client.name_quality",
      "csv_client.id",
      "csv_client.ssn",
      "csv_client.ssn_quality",
      "csv_client.ref_user_updated"
    ),
    csv_client_demographics = c(
      "csv_client_demographics.veteran_theater_afg",
      "csv_client_demographics.am_ind_ak_native",
      "csv_client_demographics.asian",
      "csv_client_demographics.black_af_american",
      "csv_client_demographics.veteran_theater_pg",
      "csv_client_demographics.veteran_discharge",
      "csv_client_demographics.ethnicity",
      "csv_client_demographics.gender",
      "csv_client_demographics.veteran_theater_iraq1",
      "csv_client_demographics.veteran_theater_iraq2",
      "csv_client_demographics.veteran_theater_kw",
      "csv_client_demographics.name_middle",
      "csv_client_demographics.veteran_branch",
      "csv_client_demographics.name_suffix",
      "csv_client_demographics.native_hi_other_pacific",
      "csv_client_demographics.veteran_theater_other",
      "csv_client_demographics.race_none",
      "csv_client_demographics.veteran",
      "csv_client_demographics.veteran_theater_vw",
      "csv_client_demographics.white",
      "csv_client_demographics.veteran_theater_ww2",
      "csv_client_demographics.veteran_entered",
      "csv_client_demographics.veteran_separated"
    ),
    csv_client_program_demographics = c(
      "csv_client_program_demographics.prior_address_quality",
      "csv_client_program_demographics.rhy_crit_substance_family",
      "csv_client_program_demographics.ssvf_targeting_field_4",
      "csv_client_program_demographics.rhy_foster_length_months",
      "csv_client_program_demographics.rhy_foster_length_years",
      "csv_client_program_demographics.path_status",
      "csv_client_program_demographics.rhy_referral_freq_approached",
      "csv_client_program_demographics.ssvf_targeting_field_11",
      "csv_client_program_demographics.added_date_date",
      "csv_client_program_demographics.path_engagement_date",
      "csv_client_program_demographics.path_status_determination",
      "csv_client_program_demographics.chronic_7",
      "csv_client_program_demographics.last_updated_date_date",
      "csv_client_program_demographics.ssvf_targeting_field_13",
      "csv_client_program_demographics.ssvf_targeting_field_10",
      "csv_client_program_demographics.disabled",
      "csv_client_program_demographics.eligible_for_rhy",
      "csv_client_program_demographics.ssvf_targeting_field_7",
      "csv_client_program_demographics.ssvf_targeting_field_17",
      "csv_client_program_demographics.ssvf_targeting_field_5",
      "csv_client_program_demographics.previous_foster_care",
      "csv_client_program_demographics.rhy_former_justice",
      "csv_client_program_demographics.ssvf_targeting_field_15",
      "csv_client_program_demographics.ssvf_targeting_field_20",
      "csv_client_program_demographics.ssvf_targeting_field_6",
      "csv_client_program_demographics.rhy_crit_incarcerated_parent",
      "csv_client_program_demographics.rhy_crit_income_family",
      "csv_client_program_demographics.ssvf_targeting_field_16",
      "csv_client_program_demographics.rhy_justice_length_months",
      "csv_client_program_demographics.rhy_justice_length_years",
      "csv_client_program_demographics.institutional_90_days",
      "csv_client_program_demographics.prior_city",
      "csv_client_program_demographics.prior_state",
      "csv_client_program_demographics.prior_street_address",
      "csv_client_program_demographics.zipcode",
      "csv_client_program_demographics.prior_duration",
      "csv_client_program_demographics.ssvf_targeting_field_9",
      "csv_client_program_demographics.current_living_situation",
      "csv_client_program_demographics.rhy_crit_mental_family",
      "csv_client_program_demographics.chronic_3",
      "csv_client_program_demographics.move_in_date_date",
      "csv_client_program_demographics.ami_percent",
      "csv_client_program_demographics.rhy_crit_disability_physical_family",
      "csv_client_program_demographics.chronic_6",
      "csv_client_program_demographics.rhy_no_svc_reason",
      "csv_client_program_demographics.path_not_enrolled_reason",
      "csv_client_program_demographics.rhy_referral_src",
      "csv_client_program_demographics.relationship_to_hoh",
      "csv_client_program_demographics.runaway_youth",
      "csv_client_program_demographics.screen_type",
      "csv_client_program_demographics.ssvf_targeting_field_12",
      "csv_client_program_demographics.rhy_sexual_orientation",
      "csv_client_program_demographics.rhy_sexual_orientation_other",
      "csv_client_program_demographics.ssvf_targeting_field_14",
      "csv_client_program_demographics.ssvf_targeting_field_8",
      "csv_client_program_demographics.ssvf_targeting_field_21",
      "csv_client_program_demographics.ssvf_targeting_field_2",
      "csv_client_program_demographics.chronic_2",
      "csv_client_program_demographics.rhy_crit_unemployment_family",
      "csv_client_program_demographics.ssvf_targeting_field_1",
      "csv_client_program_demographics.ref_user",
      "csv_client_program_demographics.vamc_station_number",
      "csv_client_program_demographics.worst_housing_situation",
      "csv_client_program_demographics.ssvf_targeting_field_3"
    ),
    csv_client_services = c(
      "csv_client_services.date_created",
      "csv_client_services.date_deleted",
      "csv_client_services.date_provided",
      "csv_client_services.date_provided_raw",
      "csv_client_services.date_updated",
      "csv_client_services.enrollment_id",
      "csv_client_services.export_id",
      "csv_client_services.fa_amount",
      "csv_client_services.other_type_provided",
      "csv_client_services.personal_id",
      "csv_client_services.record_type",
      "csv_client_services.ref_service_item",
      "csv_client_services.referral_outcome",
      "csv_client_services.services_id_raw",
      "csv_client_services.services_id",
      "csv_client_services.sub_type_provided",
      "csv_client_services.type_provided",
      "csv_client_services.user_id"
    ),
    csv_current_living_situation = c(
      "csv_current_living_situation.id",
      "csv_current_living_situation.current_living_situation",
      "csv_current_living_situation.added_date",
      "csv_current_living_situation.date_deleted",
      "csv_current_living_situation.last_updated",
      "csv_current_living_situation.ref_program",
      "csv_current_living_situation.ExportID",
      "csv_current_living_situation.program_date",
      "csv_current_living_situation.ph_60_days",
      "csv_current_living_situation.living_situation_14_days",
      "csv_current_living_situation.location_details",
      "csv_current_living_situation.moved_60_days",
      "csv_current_living_situation.ref_client",
      "csv_current_living_situation.resource_networks_ph",
      "csv_current_living_situation.screen_type",
      "csv_current_living_situation.status_screen_type",
      "csv_current_living_situation.subswquent_residence",
      "csv_current_living_situation.ref_user",
      "csv_current_living_situation.verified_by"
    ),
    csv_disabilities = c(
      "csv_disabilities.screen_type",
      "csv_disabilities.added_date",
      "csv_disabilities.date_deleted",
      "csv_disabilities.last_updated",
      "csv_disabilities.id",
      "csv_disabilities.disability_response",
      "csv_disabilities.disability_type",
      "csv_disabilities.ref_program",
      "csv_disabilities.ExportID",
      "csv_disabilities.disabling_condition",
      "csv_disabilities.program_date",
      "csv_disabilities.ref_client",
      "csv_disabilities.tcell_count_number",
      "csv_disabilities.tcell_count_available",
      "csv_disabilities.tcell_data_obtained",
      "csv_disabilities.ref_user",
      "csv_disabilities.viral_load_number",
      "csv_disabilities.viral_load_available",
      "csv_disabilities.viral_load_obtained"
    ),
    csv_employment_education = c(
      "csv_employment_education.screen_type",
      "csv_employment_education.added_date",
      "csv_employment_education.date_deleted",
      "csv_employment_education.last_updated",
      "csv_employment_education.employment_is",
      "csv_employment_education.id",
      "csv_employment_education.rhy_employment_type",
      "csv_employment_education.ref_program",
      "csv_employment_education.ExportID",
      "csv_employment_education.program_date",
      "csv_employment_education.rhy_education_level",
      "csv_employment_education.rhy_reason_not_employed",
      "csv_employment_education.ref_client",
      "csv_employment_education.rhy_school_status",
      "csv_employment_education.ref_user"
    ),
    csv_enrollment_coc = c(
      "csv_enrollment_coc.coc",
      "csv_enrollment_coc.data_collection_stage",
      "csv_enrollment_coc.added_date",
      "csv_enrollment_coc.datedeleted",
      "csv_enrollment_coc.last_updated",
      "csv_enrollment_coc.enrollment_coc_id",
      "csv_enrollment_coc.enrollment_id",
      "csv_enrollment_coc.exportid",
      "csv_enrollment_coc.ref_household",
      "csv_enrollment_coc.start_date",
      "csv_enrollment_coc.ref_client",
      "csv_enrollment_coc.id",
      "csv_enrollment_coc.ref_user"
    ),
    csv_event = c(
      "csv_event.date_created",
      "csv_event.date_deleted",
      "csv_event.date_updated",
      "csv_event.enrollment_id",
      "csv_event.event",
      "csv_event.event_date",
      "csv_event.event_id",
      "csv_event.export_id",
      "csv_event.location_crisis_or_ph_housing",
      "csv_event.personal_id",
      "csv_event.prob_sol_div_rr_result",
      "csv_event.referral_case_manage_after",
      "csv_event.referral_result",
      "csv_event.result_date",
      "csv_event.user_id"
    ),
    csv_exit = c(
      "csv_exit.aftercaredate",
      "csv_exit.rhy_aftercare_yn",
      "csv_exit.rhy_exploitation_ask",
      "csv_exit.rhy_exploitation_ask_times",
      "csv_exit.vash_case_mgt_exit_reason",
      "csv_exit.rhy_labor_exploitation_forced_tricked",
      "csv_exit.rhy_counseling",
      "csv_exit.rhy_exploitation_frequency",
      "csv_exit.added_date",
      "csv_exit.datedeleted",
      "csv_exit.last_updated",
      "csv_exit.exit_destination",
      "csv_exit.rhy_dest_safe_client",
      "csv_exit.rhy_dest_safe_caseworker",
      "csv_exit.rhy_completion_involuntary_reason",
      "csv_exit.rhy_aftercare_emailsocialmedia",
      "csv_exit.enrollment_id",
      "csv_exit.rhy_exploitation",
      "csv_exit.rhy_exploitation_times",
      "csv_exit.end_date",
      "csv_exit.id",
      "csv_exit.exportid",
      "csv_exit.rhy_counseling_family",
      "csv_exit.rhy_counseling_group",
      "csv_exit.housing_ass_exit",
      "csv_exit.rhy_aftercare_inpersongroup",
      "csv_exit.rhy_aftercare_inpersonindividual",
      "csv_exit.rhy_counseling_individual",
      "csv_exit.rhy_labor_exploitation_times",
      "csv_exit.exit_destination_other",
      "csv_exit.ref_client",
      "csv_exit.rhy_adult_connect",
      "csv_exit.rhy_community_connect",
      "csv_exit.rhy_peer_connect",
      "csv_exit.rhy_counseling_post_exit_plan",
      "csv_exit.rhy_completion_status",
      "csv_exit.rhy_counseling_num_sessions",
      "csv_exit.rhy_counseling_num_planned",
      "csv_exit.subsidy_information",
      "csv_exit.rhy_aftercare_telephone",
      "csv_exit.ref_user",
      "csv_exit.rhy_labor_exploitation_threats",
      "csv_exit.rhy_labor_exploitation_payment"
    ),
    csv_export = c(
      "csv_export.export_date",
      "csv_export.export_directive",
      "csv_export.export_end_date",
      "csv_export.export_id",
      "csv_export.export_period_type",
      "csv_export.export_start_date",
      "csv_export.hash_status",
      "csv_export.software_name",
      "csv_export.software_version",
      "csv_export.source_contact_email",
      "csv_export.souce_contact_extension",
      "csv_export.source_contact_first",
      "csv_export.source_contact_last",
      "csv_export.source_contact_phone",
      "csv_export.source_id",
      "csv_export.source_name",
      "csv_export.source_type"
    ),
    csv_funder = c(
      "csv_funder.date_created",
      "csv_funder.DateDeleted",
      "csv_funder.last_updated",
      "csv_funder.end",
      "csv_funder.ExportId",
      "csv_funder.funding_source",
      "csv_funder.id",
      "csv_funder.identifier",
      "csv_funder.non_federal_funding_source",
      "csv_funder.ref_program",
      "csv_funder.raw_id",
      "csv_funder.added",
      "csv_funder.ref_user"
    ),
    csv_health_dv = c(
      "csv_health_dv.health_dv_fleeing",
      "csv_health_dv.screen_type",
      "csv_health_dv.added_date",
      "csv_health_dv.date_deleted",
      "csv_health_dv.last_updated",
      "csv_health_dv.rhy_dental_health",
      "csv_health_dv.health_dv",
      "csv_health_dv.health_pregnancy_date",
      "csv_health_dv.ref_program",
      "csv_health_dv.ExportID",
      "csv_health_dv.health_general",
      "csv_health_dv.id",
      "csv_health_dv.program_date",
      "csv_health_dv.health_mental",
      "csv_health_dv.ref_client",
      "csv_health_dv.health_pregnancy",
      "csv_health_dv.ref_user",
      "csv_health_dv.health_dv_occurred"
    ),
    csv_income_benefits = c(
      "csv_income_benefits.health_hiv_adap",
      "csv_income_benefits.income_spousal_support_is",
      "csv_income_benefits.income_spousal_support",
      "csv_income_benefits.benefits_noncash",
      "csv_income_benefits.health_ins_cobra",
      "csv_income_benefits.income_childsupport_is",
      "csv_income_benefits.income_childsupport",
      "csv_income_benefits.soar_connected",
      "csv_income_benefits.screen_type",
      "csv_income_benefits.added_date",
      "csv_income_benefits.date_deleted",
      "csv_income_benefits.last_updated",
      "csv_income_benefits.income_earned_is",
      "csv_income_benefits.income_earned",
      "csv_income_benefits.health_ins_emp",
      "csv_income_benefits.ref_program",
      "csv_income_benefits.export_id",
      "csv_income_benefits.income_ga_is",
      "csv_income_benefits.income_ga",
      "csv_income_benefits.health_hiv",
      "csv_income_benefits.id",
      "csv_income_benefits.income_cash",
      "csv_income_benefits.c_indian_health_service_program",
      "csv_income_benefits.program",
      "csv_income_benefits.health_insurance",
      "csv_income_benefits.benefits_medicaid",
      "csv_income_benefits.benefits_medicare",
      "csv_income_benefits.hopwa_hiv_adap_reason",
      "csv_income_benefits.hopwa_cobra_reason",
      "csv_income_benefits.hopwa_emp_reason",
      "csv_income_benefits.hopwa_hiv_services_reason",
      "csv_income_benefits.indian_health_reason",
      "csv_income_benefits.hopwa_medicaid_reason",
      "csv_income_benefits.hopwa_medicare_reason",
      "csv_income_benefits.hopwa_ppay_reason",
      "csv_income_benefits.hopwa_schip_reason",
      "csv_income_benefits.hopwa_state_reason",
      "csv_income_benefits.hopwa_va_medical_reason",
      "csv_income_benefits.benefits_other",
      "csv_income_benefits.benefits_other_source",
      "csv_income_benefits.income_other",
      "csv_income_benefits.income_other_is",
      "csv_income_benefits.income_other_source",
      "csv_income_benefits.other_health_insurance",
      "csv_income_benefits.other_health_insurance_specify",
      "csv_income_benefits.benefits_tanf_other",
      "csv_income_benefits.income_private_pension_is",
      "csv_income_benefits.income_private_pension",
      "csv_income_benefits.ref_client",
      "csv_income_benefits.income_private_disability_is",
      "csv_income_benefits.income_private_disability",
      "csv_income_benefits.health_ins_ppay",
      "csv_income_benefits.benefits_schip",
      "csv_income_benefits.benefit_snap",
      "csv_income_benefits.income_ssdi_is",
      "csv_income_benefits.income_ssdi",
      "csv_income_benefits.income_ssi_is",
      "csv_income_benefits.income_ssi",
      "csv_income_benefits.income_ss_retirement_is",
      "csv_income_benefits.income_ss_retirement",
      "csv_income_benefits.health_ins_state",
      "csv_income_benefits.income_tanf_is",
      "csv_income_benefits.income_tanf",
      "csv_income_benefits.benefits_tanf_childcare",
      "csv_income_benefits.benefits_tanf_transportation",
      "csv_income_benefits.income_individual",
      "csv_income_benefits.income_unemployment_is",
      "csv_income_benefits.income_unemployment",
      "csv_income_benefits.ref_user",
      "csv_income_benefits.income_vet_pension_is",
      "csv_income_benefits.income_vet_pension",
      "csv_income_benefits.income_vet_disability_is",
      "csv_income_benefits.income_vet_disability",
      "csv_income_benefits.benefits_va_medical",
      "csv_income_benefits.benefits_wic",
      "csv_income_benefits.income_workers_comp_is",
      "csv_income_benefits.income_workers_comp"
    ),
    csv_inventory = c(
      "csv_inventory.availability",
      "csv_inventory.bed_inventory",
      "csv_inventory.chronic_inventory",
      "csv_inventory.bed_ch_veteran",
      "csv_inventory.bed_ch_youth",
      "csv_inventory.coc",
      "csv_inventory.added_date",
      "csv_inventory.date_deleted",
      "csv_inventory.last_updated",
      "csv_inventory.ref_bed_type",
      "csv_inventory.export_id",
      "csv_inventory.ref_household_type",
      "csv_inventory.end_date",
      "csv_inventory.id",
      "csv_inventory.start_date",
      "csv_inventory.bed_non_dedicated",
      "csv_inventory.ref_program",
      "csv_inventory.unit_inventory",
      "csv_inventory.ref_user_updated",
      "csv_inventory.veteran_inventory",
      "csv_inventory.youth_inventory",
      "csv_inventory.bed_youth_veteran"
    ),
    csv_organization = c(
      "csv_organization.added",
      "csv_organization.deleted",
      "csv_organization.last_updated",
      "csv_organization.export_id",
      "csv_organization.common_name",
      "csv_organization.id",
      "csv_organization.name",
      "csv_organization.ref_user_updated",
      "csv_organization.victim_service_provider"
    ),
    csv_project = c(
      "csv_project.continuum_project",
      "csv_project.date_created",
      "csv_project.date_deleted",
      "csv_project.date_updated",
      "csv_project.export_id",
      "csv_project.hmis_participating_project",
      "csv_project.housing_type",
      "csv_project.operating_end_date",
      "csv_project.operating_start_date",
      "csv_project.organization_id",
      "csv_project.pit_count",
      "csv_project.project_common_name",
      "csv_project.project_id",
      "csv_project.project_name",
      "csv_project.project_type",
      "csv_project.residential_affiliation",
      "csv_project.ref_target_b",
      "csv_project.tracking_method",
      "csv_project.user_id"
    ),
    csv_project_coc = c(
      "csv_project_coc.address",
      "csv_project_coc.address2",
      "csv_project_coc.city",
      "csv_project_coc.coc",
      "csv_project_coc.added_date",
      "csv_project_coc.date_deleted",
      "csv_project_coc.last_updated",
      "csv_project_coc.export_id",
      "csv_project_coc.ref_geolocation",
      "csv_project_coc.ref_geography_type",
      "csv_project_coc.id",
      "csv_project_coc.ref_program",
      "csv_project_coc.state",
      "csv_project_coc.ref_user_updated",
      "csv_project_coc.zipcode"
    ),
    csv_user = c(
      "csv_user.date_created",
      "csv_user.date_deleted",
      "csv_user.date_updated",
      "csv_user.export_id",
      "csv_user.ref_agency",
      "csv_user.user_email",
      "csv_user.user_extension",
      "csv_user.user_first_name",
      "csv_user.user_id",
      "csv_user.user_last_name",
      "csv_user.user_phone"
    ),
    export = c(
      "export.datedeleted",
      "export.date_of_bcpstatus",
      "export.end_date",
      "export.end_day_of_month",
      "export.end_day_of_week",
      "export.end_day_of_week_index",
      "export.end_day_of_year",
      "export.end_hour",
      "export.end_hour_of_day",
      "export.end_minute",
      "export.end_month",
      "export.end_month_name",
      "export.end_month_num",
      "export.end_quarter",
      "export.end_quarter_of_year",
      "export.end_raw",
      "export.end_time",
      "export.end_time_of_day",
      "export.end_week",
      "export.end_week_of_year",
      "export.end_year",
      "export.id",
      "export.start",
      "export.exportid",
      "export.ref_household",
      "export.ref_client",
      "export.ref_program",
      "export.reporting_period_end_date",
      "export.reporting_period_start_date",
      "csv_export.export_date",
      "csv_export.export_directive",
      "csv_export.export_end_date",
      "csv_export.export_id",
      "csv_export.export_period_type",
      "csv_export.export_start_date",
      "csv_export.hash_status",
      "csv_export.software_name",
      "csv_export.software_version",
      "csv_export.source_contact_email",
      "csv_export.souce_contact_extension",
      "csv_export.source_contact_first",
      "csv_export.source_contact_last",
      "csv_export.source_contact_phone",
      "csv_export.source_id",
      "csv_export.source_name",
      "csv_export.source_type"
    ),
    query_constants = "query_constants.missing_field"
  )


# purrr::map(.hud_export, ~{
#   if (!is.null(.x$fields))
#     .x$fields <- setNames(.x$fields, stringr::str_split(.x$fields, "\\.", simplify = TRUE)[,2] %>% snakecase::to_upper_camel_case() %>% hud_rename_strings())
#   .x
# }) %>% dput()
